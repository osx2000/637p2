global {
 table cyc(harm,128,1);
 srate 44100;
}

instr piano (fr) {
 imports exports table cyc;

 ksig env01,env02,env03,env04,env05,env06,env07,env08,env09,env10,env11,env12,env13,env14,env15,env16,env17,env18,env19,env20;

 asig y01,y02,y03,y04,y05,y06,y07,y08,y09,y10,y11,y12,y13,y14,y15,y16,y17,y18,y19,y20;



// **********************
// computed during k-pass

env01 = kline(0,
	0.001608, 0.336494,
	0.001608, 0.308058,
	0.001608, 0.278196,
	0.001608, 0.258039,
	0.001608, 0.260641,
	0.001608, 0.295690,
	0.001608, 0.316632,
	0.001608, 0.310612,
	0.001608, 0.307274,
	0.001608, 0.306330,
	0.001608, 0.287378,
	0.001608, 0.272150,
	0.001608, 0.279148,
	0.001608, 0.295809,
	0.001608, 0.301878,
	0.001608, 0.290883,
	0.001608, 0.289836,
	0.001608, 0.286735,
	0.001608, 0.263124,
	2.461415, 0.004382);

env02 = kline(0,
	0.001608, 0.097396,
	0.001608, 0.081971,
	0.001608, 0.078928,
	0.001608, 0.081134,
	0.001608, 0.097987,
	0.001608, 0.116144,
	0.001608, 0.103577,
	0.001608, 0.091460,
	0.001608, 0.099965,
	0.001608, 0.108654,
	0.001608, 0.113417,
	0.001608, 0.107681,
	0.001608, 0.100559,
	0.001608, 0.098103,
	0.001608, 0.093345,
	0.001608, 0.098146,
	0.001608, 0.107229,
	0.008039, 0.120713,
	2.223473, 0.005691,
	0.233119, 0.004139);

env03 = kline(0,
	0.001608, 0.103600,
	0.001608, 0.106860,
	0.001608, 0.112101,
	0.001608, 0.116215,
	0.001608, 0.123191,
	0.001608, 0.119543,
	0.001608, 0.119140,
	0.001608, 0.119905,
	0.001608, 0.122436,
	0.001608, 0.129068,
	0.001608, 0.136940,
	0.001608, 0.143915,
	0.001608, 0.146819,
	0.001608, 0.146513,
	0.001608, 0.143305,
	0.001608, 0.140883,
	0.001608, 0.142182,
	0.001608, 0.142203,
	0.001608, 0.141665,
	2.461415, 0.005852);

env04 = kline(0,
	0.001608, 0.065044,
	0.001608, 0.066805,
	0.001608, 0.063529,
	0.001608, 0.061627,
	0.001608, 0.067660,
	0.001608, 0.075400,
	0.001608, 0.077307,
	0.000000, 0.077307,
	0.001608, 0.076582,
	0.001608, 0.074395,
	0.001608, 0.072471,
	0.001608, 0.074500,
	0.001608, 0.073022,
	0.001608, 0.071385,
	0.001608, 0.069804,
	0.001608, 0.068713,
	0.001608, 0.069175,
	0.001608, 0.067854,
	0.001608, 0.068157,
	2.463022, 0.001607);

env05 = kline(0,
	0.001608, 0.079765,
	0.001608, 0.091854,
	0.001608, 0.096673,
	0.001608, 0.100792,
	0.001608, 0.103992,
	0.001608, 0.101750,
	0.001608, 0.102719,
	0.001608, 0.103529,
	0.001608, 0.102229,
	0.001608, 0.099122,
	0.001608, 0.097087,
	0.001608, 0.092725,
	0.001608, 0.090962,
	0.001608, 0.089347,
	0.001608, 0.089255,
	0.001608, 0.088486,
	0.001608, 0.089046,
	0.001608, 0.088517,
	0.001608, 0.089240,
	2.461415, 0.003554);

env06 = kline(0,
	0.001608, 0.026125,
	0.001608, 0.032187,
	0.001608, 0.033016,
	0.001608, 0.032131,
	0.001608, 0.025887,
	0.001608, 0.026114,
	0.001608, 0.028025,
	0.001608, 0.031280,
	0.001608, 0.030572,
	0.001608, 0.032152,
	0.001608, 0.030890,
	0.001608, 0.030604,
	0.001608, 0.028888,
	0.001608, 0.029930,
	0.001608, 0.028875,
	0.001608, 0.029094,
	0.001608, 0.027350,
	0.001608, 0.028219,
	0.001608, 0.027340,
	2.461415, 0.000891);

env07 = kline(0,
	0.001608, 0.009863,
	0.001608, 0.010075,
	0.001608, 0.016387,
	0.001608, 0.018609,
	0.001608, 0.019457,
	0.001608, 0.021108,
	0.001608, 0.021923,
	0.006431, 0.023717,
	0.123794, 0.010147,
	0.421222, 0.007429,
	0.810289, 0.001580,
	0.078778, 0.001993,
	0.118971, 0.002346,
	0.175241, 0.002597,
	0.385852, 0.001029,
	0.151125, 0.000514,
	0.064309, 0.000399,
	0.049839, 0.000299,
	0.030547, 0.000309,
	0.064309, 0.000259);

env08 = kline(0,
	0.008039, 0.062370,
	2.104501, 0.000911,
	0.035370, 0.000841,
	0.035370, 0.000669,
	0.027331, 0.000642,
	0.028939, 0.000531,
	0.024116, 0.000447,
	0.017685, 0.000449,
	0.017685, 0.000418,
	0.017685, 0.000377,
	0.014469, 0.000408,
	0.016077, 0.000405,
	0.016077, 0.000418,
	0.012862, 0.000529,
	0.020900, 0.000512,
	0.017685, 0.000623,
	0.022508, 0.000667,
	0.027331, 0.000718,
	0.027331, 0.000804,
	0.000000, 0.000804);

env09 = kline(0,
	0.003215, 0.009801,
	2.231511, 0.000055,
	0.012862, 0.000062,
	0.022508, 0.000039,
	0.006431, 0.000077,
	0.022508, 0.000077,
	0.006431, 0.000110,
	0.027331, 0.000067,
	0.016077, 0.000079,
	0.022508, 0.000060,
	0.006431, 0.000086,
	0.020900, 0.000082,
	0.019293, 0.000046,
	0.004823, 0.000075,
	0.022508, 0.000052,
	0.025723, 0.000019,
	0.001608, 0.000072,
	0.016077, 0.000028,
	0.003215, 0.000040,
	0.000000, 0.000040);

env10 = kline(0,
	0.006431, 0.008239,
	2.236334, 0.000025,
	0.001608, 0.000053,
	0.014469, 0.000045,
	0.008039, 0.000055,
	0.012862, 0.000054,
	0.016077, 0.000051,
	0.006431, 0.000078,
	0.019293, 0.000073,
	0.024116, 0.000048,
	0.022508, 0.000042,
	0.009646, 0.000055,
	0.017685, 0.000045,
	0.006431, 0.000059,
	0.019293, 0.000058,
	0.020900, 0.000048,
	0.016077, 0.000055,
	0.019293, 0.000055,
	0.014469, 0.000075,
	0.000000, 0.000075);

env11 = kline(0,
	0.004823, 0.017322,
	2.413183, 0.000040,
	0.006431, 0.000023,
	0.001608, 0.000038,
	0.001608, 0.000063,
	0.003215, 0.000042,
	0.006431, 0.000059,
	0.008039, 0.000050,
	0.003215, 0.000083,
	0.003215, 0.000052,
	0.006431, 0.000057,
	0.001608, 0.000087,
	0.004823, 0.000053,
	0.006431, 0.000067,
	0.003215, 0.000081,
	0.003215, 0.000041,
	0.003215, 0.000075,
	0.004823, 0.000118,
	0.006431, 0.000068,
	0.000000, 0.000068);

env12 = kline(0,
	0.001608, 0.007191,
	0.003215, 0.007332,
	2.446945, 0.000058,
	0.003215, 0.000063,
	0.001608, 0.000030,
	0.001608, 0.000026,
	0.003215, 0.000040,
	0.008039, 0.000035,
	0.001608, 0.000028,
	0.001608, 0.000050,
	0.001608, 0.000020,
	0.001608, 0.000037,
	0.001608, 0.000024,
	0.003215, 0.000037,
	0.001608, 0.000034,
	0.001608, 0.000064,
	0.003215, 0.000022,
	0.001608, 0.000031,
	0.003215, 0.000054,
	0.000000, 0.000054);

env13 = kline(0,
	0.014469, 0.004946,
	2.308682, 0.000054,
	0.025723, 0.000038,
	0.016077, 0.000028,
	0.004823, 0.000038,
	0.014469, 0.000026,
	0.001608, 0.000054,
	0.004823, 0.000021,
	0.004823, 0.000032,
	0.004823, 0.000047,
	0.001608, 0.000024,
	0.006431, 0.000036,
	0.019293, 0.000030,
	0.001608, 0.000052,
	0.025723, 0.000035,
	0.016077, 0.000029,
	0.016077, 0.000014,
	0.003215, 0.000042,
	0.001608, 0.000022,
	0.000000, 0.000022);

env14 = kline(0,
	0.001608, 0.007540,
	2.440514, 0.000010,
	0.001608, 0.000028,
	0.001608, 0.000036,
	0.003215, 0.000010,
	0.001608, 0.000030,
	0.004823, 0.000018,
	0.003215, 0.000029,
	0.006431, 0.000008,
	0.001608, 0.000012,
	0.001608, 0.000020,
	0.001608, 0.000025,
	0.003215, 0.000011,
	0.001608, 0.000023,
	0.006431, 0.000008,
	0.001608, 0.000021,
	0.001608, 0.000026,
	0.003215, 0.000008,
	0.003215, 0.000014,
	0.001608, 0.000005);

env15 = kline(0,
	0.004823, 0.002273,
	2.366560, 0.000017,
	0.001608, 0.000022,
	0.003215, 0.000018,
	0.006431, 0.000039,
	0.009646, 0.000018,
	0.001608, 0.000029,
	0.003215, 0.000029,
	0.032154, 0.000015,
	0.001608, 0.000035,
	0.024116, 0.000011,
	0.006431, 0.000016,
	0.001608, 0.000037,
	0.004823, 0.000011,
	0.001608, 0.000022,
	0.004823, 0.000033,
	0.003215, 0.000015,
	0.012862, 0.000014,
	0.001608, 0.000026,
	0.000000, 0.000026);

env16 = kline(0,
	0.001608, 0.003429,
	2.390675, 0.000027,
	0.012862, 0.000039,
	0.008039, 0.000020,
	0.014469, 0.000012,
	0.004823, 0.000021,
	0.001608, 0.000039,
	0.009646, 0.000012,
	0.001608, 0.000024,
	0.003215, 0.000049,
	0.014469, 0.000011,
	0.003215, 0.000028,
	0.004823, 0.000016,
	0.006431, 0.000023,
	0.001608, 0.000043,
	0.003215, 0.000021,
	0.001608, 0.000033,
	0.004823, 0.000010,
	0.003215, 0.000015,
	0.000000, 0.000015);

env17 = kline(0,
	0.001608, 0.005710,
	0.001608, 0.005754,
	0.001608, 0.005380,
	0.001608, 0.004681,
	0.001608, 0.004391,
	0.130225, 0.006136,
	2.252412, 0.000023,
	0.011254, 0.000016,
	0.009646, 0.000014,
	0.004823, 0.000022,
	0.008039, 0.000022,
	0.011254, 0.000017,
	0.003215, 0.000027,
	0.016077, 0.000014,
	0.006431, 0.000019,
	0.011254, 0.000019,
	0.009646, 0.000010,
	0.001608, 0.000030,
	0.008039, 0.000023,
	0.000000, 0.000023);

env18 = kline(0,
	0.001608, 0.001431,
	0.001608, 0.001297,
	0.001608, 0.001333,
	0.001608, 0.001291,
	2.371383, 0.000038,
	0.019293, 0.000015,
	0.019293, 0.000015,
	0.032154, 0.000007,
	0.001608, 0.000018,
	0.003215, 0.000023,
	0.008039, 0.000005,
	0.003215, 0.000021,
	0.001608, 0.000014,
	0.001608, 0.000010,
	0.011254, 0.000023,
	0.003215, 0.000019,
	0.001608, 0.000006,
	0.004823, 0.000006,
	0.003215, 0.000011,
	0.000000, 0.000011);

env19 = kline(0,
	0.001608, 0.001002,
	0.107717, 0.001081,
	2.194534, 0.000022,
	0.017685, 0.000036,
	0.025723, 0.000018,
	0.024116, 0.000020,
	0.008039, 0.000043,
	0.006431, 0.000023,
	0.019293, 0.000015,
	0.019293, 0.000016,
	0.003215, 0.000040,
	0.008039, 0.000012,
	0.011254, 0.000015,
	0.012862, 0.000024,
	0.012862, 0.000042,
	0.008039, 0.000008,
	0.001608, 0.000014,
	0.004823, 0.000015,
	0.004823, 0.000032,
	0.000000, 0.000032);

env20 = kline(0,
	0.054662, 0.001350,
	2.382637, 0.000020,
	0.006431, 0.000036,
	0.008039, 0.000005,
	0.001608, 0.000010,
	0.001608, 0.000011,
	0.001608, 0.000018,
	0.004823, 0.000016,
	0.003215, 0.000007,
	0.001608, 0.000013,
	0.001608, 0.000027,
	0.001608, 0.000028,
	0.003215, 0.000011,
	0.004823, 0.000009,
	0.001608, 0.000019,
	0.001608, 0.000030,
	0.004823, 0.000008,
	0.001608, 0.000011,
	0.004823, 0.000011,
	0.000000, 0.000011);



// **********************
// computed during a-pass

y01 = env01 * oscil(cyc, fr * 1);
y02 = env02 * oscil(cyc, fr * 2);
y03 = env03 * oscil(cyc, fr * 3);
y04 = env04 * oscil(cyc, fr * 4);
y05 = env05 * oscil(cyc, fr * 5);
y06 = env06 * oscil(cyc, fr * 6);
y07 = env07 * oscil(cyc, fr * 7);
y08 = env08 * oscil(cyc, fr * 8);
y09 = env09 * oscil(cyc, fr * 9);
y10 = env10 * oscil(cyc, fr * 10);
y11 = env11 * oscil(cyc, fr * 11);
y12 = env12 * oscil(cyc, fr * 12);
y13 = env13 * oscil(cyc, fr * 13);
y14 = env14 * oscil(cyc, fr * 14);
y15 = env15 * oscil(cyc, fr * 15);
y16 = env16 * oscil(cyc, fr * 16);
y17 = env17 * oscil(cyc, fr * 17);
y18 = env18 * oscil(cyc, fr * 18);
y19 = env19 * oscil(cyc, fr * 19);
y20 = env20 * oscil(cyc, fr * 20);

output(y01+y02+y03+y04+y05+y06+y07+y08+y09+y10+y11+y12+y13+y14+y15+y16+y17+y18+y19+y20);

}